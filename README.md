# Coursework Shop API

## Опис проєкту

Coursework Shop API — серверна частина інтернет-магазину, розроблена в межах
курсової роботи. Проєкт реалізує базові та розширені бізнес-процеси електронної
комерції, включаючи управління користувачами, товарами, замовленнями та аналітикою.

API побудоване за принципами REST та забезпечує:
- роботу з користувачами та їх замовленнями;
- управління товарами і категоріями;
- підтримку історії змін даних;
- аналітичні запити для бізнес-аналізу;
- безпечну роботу з конкурентними оновленнями.

---

## Члени команди

- Вероніка — реалізація Products API, бізнес-логіка товарів, аналітичні SQL-запити,
  інтеграційні тести (Products, Orders), документація API
- Юля — ініціалізація проєкту, архітектура серверної частини, проєктування схеми
  бази даних, Prisma schema та міграції, Docker, документація схеми БД

---

## Технологічний стек

- Node.js — серверне середовище виконання
- TypeScript — основна мова програмування
- Express.js — HTTP-сервер і маршрутизація
- PostgreSQL — реляційна база даних
- Prisma ORM — робота зі схемою та запитами до БД
- Docker / Docker Compose — контейнеризація бази даних
- Jest + Supertest — інтеграційне тестування

---

## Мова програмування та версія

- TypeScript
- Node.js (LTS)

---

## ORM / SQL Builder

- Prisma ORM

---

## Фреймворк тестування

- Jest
- Supertest

---

## Інструкції з налаштування

### 1. Клонування репозиторію

```bash
git clone https://github.com/Sakhniuk/coursework-shop.git
cd coursework-shop

2. Встановлення залежностей
bash
Копіювати код
npm install

3. Запуск бази даних (Docker)
bash
Копіювати код
docker-compose up -d

4. Налаштування змінних середовища
Створіть файл .env у корені проєкту та додайте:
env
Копіювати код
DATABASE_URL=postgresql://shop:shop@localhost:5433/shopdb
PORT=3000

5. Запуск міграцій бази даних
bash
Копіювати код
npx prisma migrate dev
Подальші розділи README містять опис запуску додатку,
тестування, структури проєкту та приклади API.

yaml
Копіювати код

## Запуск додатку

Після запуску бази даних та виконання міграцій, сервер додатку можна запустити
в режимі розробки за допомогою команди:

```bash
npm run dev

Після успішного запуску API буде доступне за адресою:
http://localhost:3000

Для перевірки працездатності сервера та з’єднання з базою даних
передбачений health-check endpoint:
GET /health


Запуск тестів

У проєкті реалізовані інтеграційні тести з використанням Jest та Supertest,
які перевіряють коректність роботи основних бізнес-процесів.

Для запуску всіх тестів використовується команда: npm test

Тести охоплюють:
- створення та оновлення товарів;
- створення замовлень користувачів;
- оновлення статусів замовлень;
- soft delete записів;
- механізм optimistic locking при конкурентних оновленнях.


Структура проєкту

Проєкт має чітко організовану структуру каталогів:

src/ — основний код серверного застосунку:
- routes/ — HTTP-роути (Products, Orders, Users)
- services/ — бізнес-логіка та взаємодія з базою даних
- db.ts — ініціалізація Prisma Client
- app.ts — точка входу додатку

prisma/ — схема бази даних та міграції

tests/ — інтеграційні тести API

docs/ — документація проєкту

docker-compose.yml — конфігурація PostgreSQL

package.json — залежності та скрипти запуску


Приклади API

Health-check

GET /health

Використовується для перевірки доступності сервера та з’єднання з базою даних.



Товари (Products)

- Створення товару:
POST /products

- Отримання списку товарів:
GET /products

- Пошук товарів за назвою або SKU:
GET /products/search?q=phone

- Оновлення ціни товару з використанням optimistic locking:
PATCH /products/price

- Логічне видалення товару (soft delete):
DELETE /products/:id

- Аналітика — топ товарів у кожній категорії:
GET /products/analytics/top


Замовлення (Orders)

- Створення замовлення з товарами:
POST /orders

- Отримання списку замовлень користувача:
GET /orders/by-user/:userId

- Оновлення статусу замовлення з optimistic locking:
PATCH /orders/status


Користувачі (Users)

- Отримання списку користувачів:
GET /users

- Логічне видалення користувача:
DELETE /users/:id

- Аналітика Customer Lifetime Value (LTV):
GET /users/analytics/ltv

